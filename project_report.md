# Отчёт по проекту: Единый глоссарий терминов ВНД

## Проделанная работа

### Архитектура проекта
- Реализована базовая структура проекта с разделением на бэкенд и фронтенд части
- Настроена контейнеризация с использованием Docker и Docker Compose
- Настроено взаимодействие между компонентами системы

### Бэкенд (FastAPI)
- Разработана асинхронная архитектура на базе FastAPI
- Настроено подключение к MongoDB с использованием асинхронного драйвера Motor
- Реализована система авторизации и аутентификации на JWT токенах
- **Разработаны и реализованы модели данных для:**
  - Терминов (`Term`, `TermDefinition`)
  - Нормативных документов (`Document`)
  - Связей между терминами и документами (`TermDocumentRelation`)
- **Реализованы CRUD операции для:**
  - Пользователей (`CRUDUser`)
  - Терминов (`CRUDTerm`)
  - Нормативных документов (`CRUDDocument`)
  - Связей между терминами и документами (`CRUDTermDocument`)
- Разработаны базовые CRUD тесты для терминов, документов и связей
- Настроена документация API через Swagger и ReDoc
- Обновлена конфигурация базы данных для включения новых коллекций и индексов

### Фронтенд (React)
- Настроена базовая структура приложения на React с использованием Vite
- Созданы основные компоненты интерфейса
- Подготовлена архитектура для взаимодействия с бэкендом
- **Реализованы клиентские модули API для взаимодействия с бэкендом (terms.js, documents.js, termDocumentRelations.js)**
- **Реализованы страницы:**
  - Страница поиска терминов (`SearchPage.jsx`)
  - Страница детального просмотра термина (`TermPage.jsx`) с отображением определений, истории определений и связанных документов
  - Страница панели управления (`DashboardPage.jsx`) с отображением статистики терминов и отчета о конфликтах
  - **Страница детального просмотра документа (`DocumentPage.jsx`) с отображением информации о документе и связанных терминах**
- **Доработаны компоненты для отображения данных:**
  - Компонент `TermItem.jsx` для отображения термина в списках
  - Компонент `DocumentItem.jsx` для отображения документа в списках
  - Компонент `TermConflictReport.jsx` для отображения отчета о конфликтах для термина
  - Компонент `TermStatisticsTable.jsx` для отображения статистики терминов
  - Компонент `AllConflictsReportList.jsx` для отображения полного отчета о конфликтах
- **Реализован базовый функционал:**
  - Поиск терминов на главной странице
  - Отображение связанных документов на странице термина
  - Отображение истории определений на странице термина с информацией об источнике
  - Отображение отчета о конфликтах для термина на его странице
  - Отображение статистики терминов и полного отчета о конфликтах на панели управления
  - **Переход на страницу документа при клике на его название**
- **Реализована логика выхода из системы при истечении токена авторизации**
- **Исправлены ошибки, связанные с валидацией ответов API, порядком маршрутов и отображением данных на фронтенде**

### Инфраструктура
- Настроена система контейнеризации на базе Docker
- Подготовлены конфигурационные файлы для локальной разработки

## Предстоящие задачи

### API
1. **API для работы с терминами**:
   - Создание, чтение, обновление, удаление терминов
   - Поиск терминов по различным параметрам
   - Управление историей версий определений (просмотр через модель термина)
   - Получение списка документов, использующих термин (Реализовано: `GET /api/v1/terms/{term_id}/documents`)

2. **API для работы с ВНД**:
   - Регистрация нового документа
   - **Получение списка терминов, используемых в документе (Реализовано: `GET /api/v1/documents/{doc_id}/terms`)**
   - Управление связями термин-документ (Реализовано в `term_document_relations.py`)
   - **Получение документа по ID (Реализовано: `GET /api/v1/documents/{doc_id}`, обновлена response_model на DocumentPublic)**

3. **API анализа и проверки**:
   - Выявление и отчетность по разночтениям в определениях одинаковых терминов (Реализовано получение отчета для термина: `GET /api/v1/term_document_relations/conflicts/{term_id}`, реализовано получение полного отчета: `GET /api/v1/term_document_relations/conflicts`)
   - Статистика использования терминов по документам (Реализовано: `GET /api/v1/terms/statistics`)
   - Анализ непротиворечивости терминологии (Реализовано получение полного отчета: `GET /api/v1/term_document_relations/conflicts`)

### Интерфейс пользователя
1. **Поисковый интерфейс**:
   - Реализовать удобный поиск по терминам
   - Отображение текущего и исторических определений термина
   - Список документов, использующих термин

2. **Управление терминами**:
   - Интерфейс для добавления/редактирования терминов
   - Механизм разрешения конфликтов определений
   - Модерация и утверждение терминов и определений

3. **Управление документами**:
   - Интерфейс для регистрации новых ВНД
   - Просмотр используемых в документе терминов и их определений
   - Предупреждения о возможных разночтениях при просмотре документа

4. **Панель администратора**:
   - Управление пользователями и ролями
   - Модерация изменений в определениях терминов
   - Статистика и аналитика по использованию терминов и документов

### Дополнительные возможности
1. **Импорт/экспорт**:
   - Инструменты для пакетного импорта терминов и документов
   - Экспорт глоссария в различных форматах (PDF, Excel)

2. **Интеграции**:
   - Интеграция с системой документооборота университета
   - API для использования глоссария в других системах
   - Возможность парсинга документов для автоматического извлечения терминов и определений

## План реализации

1. **Этап 1: Модели данных и основной CRUD** (Завершено)
   - Разработка моделей для терминов, документов и связей (завершено)
   - Реализация базовых CRUD операций для всех моделей (завершено)
   - Настройка коллекций и индексов в базе данных (завершено)

2. **Этап 2: API и бизнес-логика** (Завершено)
   - Создание API эндпоинтов для работы с терминами, документами и связями (Реализовано)
   - Реализация логики проверки разночтений и формирования отчетов о конфликтах (Реализовано)
   - Реализация версионирования определений через API (Просмотр истории определений доступен через модель термина)
   - Добавлены эндпоинты для получения связанных документов термина и связанных терминов документа.
   - Созданы API эндпоинты для статистики использования терминов (`GET /api/v1/terms/statistics`) и полного отчета о конфликтах (`GET /api/v1/term_document_relations/conflicts`).
   - Добавлены тесты для новых API эндпоинтов и проверки удаления связанных связей.
   - **Добавлены и доработаны API эндпоинты для получения отдельных документов и списков документов, а также API эндпоинт для получения списка терминов, связанных с документом.**

3. **Этап 3: Пользовательский интерфейс** (В процессе)
   - **Реализация интерфейса поиска и просмотра глоссария (Базовое отображение реализовано, требуются улучшения UI/UX)**
   - Разработка интерфейсов управления контентом (термины, документы, связи)
   - Создание административной панели

4. **Этап 4: Тестирование и доработки**
   - Написание и проведение интеграционных и unit тестов
   - Исправление выявленных ошибок
   - Оптимизация производительности и безопасности

## Тестирование

Тестирование проекта будет основано на фреймворке pytest с использованием плагина pytest-asyncio для поддержки асинхронных тестов. Для интеграционного тестирования с базой данных будет использоваться подход сFixture, как реализовано в `conftest.py`, что позволяет создавать временные тестовые базы данных или изолировать тестовые окружения.

### Текущие тестовые модули:
- `test_db_connection.py`: Тесты на подключение и базовую работу с базой данных.
- `test_auth.py`: Unit тесты для функций аутентификации (например, хеширование паролей, создание токенов).
- `test_auth_api.py`: Интеграционные тесты для API эндпоинтов аутентификации.
- `test_users.py`: Интеграционные тесты для API эндпоинтов управления пользователями и CRUD операций с пользователями.
- `test_term_document_relations.py`: Интеграционные тесты для API эндпоинтов управления связями (создание, чтение, удаление, проверка и обновление статуса конфликтов).
- `test_conflict_detection.py`: Unit или интеграционные тесты для специфической логики выявления разночтений в определениях терминов.

Тесты базовых CRUD операций для терминов, документов и связей (`test_terms.py`, `test_documents.py`, `test_term_document_relations.py` в папке `crud`) разработаны и успешно проходят.

## Технологический стек

- **Бэкенд**: FastAPI, Python, Motor (асинхронный MongoDB драйвер)
- **База данных**: MongoDB
- **Фронтенд**: React, Vite
- **Контейнеризация**: Docker, Docker Compose
- **Аутентификация**: JWT

## Текущий статус проекта

На данный момент реализована базовая инфраструктура проекта. Уже создана система авторизации и аутентификации пользователей, настроены основные компоненты архитектуры. Проект готов для разработки специфичного функционала глоссария терминов.

Следующим шагом является разработка моделей данных для терминов и документов, а также реализация соответствующего API. 