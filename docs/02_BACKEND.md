# Бэкенд Архитектура

Бэкенд этого проекта построен на основе микросервисной архитектуры с использованием FastAPI для создания REST API. Каждый микросервис отвечает за определенную часть функциональности.

## Ключевые Принципы

*   **Разделение Ответственности**: Каждый сервис имеет четко определенную зону ответственности.
*   **Независимое Масштабирование**: Сервисы могут масштабироваться независимо друг от друга.
*   **Независимое Развертывание**: В теории, каждый сервис можно обновлять и развертывать отдельно (хотя в данной заготовке они управляются единым `docker-compose.yml`).
*   **Общий Код**: Переиспользуемые компоненты (модели, утилиты, конфигурация) вынесены в директорию `backend/shared/`.

## Основные Компоненты

1.  **Микросервисы**:
    *   `auth_service`: Отвечает за аутентификацию (логин, регистрация, выдача токенов) и авторизацию.
    *   `user_service`: Отвечает за управление данными пользователей (CRUD операции над пользователями, профили и т.д.).
    *   *При необходимости сюда можно добавлять новые микросервисы (например, `product_service`, `order_service` и т.д.).*
    *   Подробнее: [02.1_MICROSERVICES.md](02.1_MICROSERVICES.md)

2.  **Общие Модули (`backend/shared/`)**:
    *   Содержит код, который используется несколькими (или всеми) микросервисами. Это помогает избежать дублирования и поддерживать консистентность.
    *   Подробнее: [02.2_SHARED_MODULES.md](02.2_SHARED_MODULES.md)

3.  **Аутентификация и Авторизация**:
    *   Реализована с использованием JWT (JSON Web Tokens), включая access и refresh токены.
    *   Подробнее: [02.3_AUTHENTICATION.md](02.3_AUTHENTICATION.md)

## Взаимодействие между сервисами

В данной заготовке прямое синхронное взаимодействие между микросервисами через HTTP-запросы не реализовано из коробки для простоты. Если такая необходимость возникнет, можно использовать:

*   **Асинхронные HTTP-клиенты** (например, `httpx`) внутри сервисов.
*   **Очереди сообщений** (например, RabbitMQ или Kafka, хотя Redis уже есть и может использоваться для простых сценариев) для асинхронного взаимодействия.

## Маршрутизация и API

*   Каждый сервис FastAPI использует `APIRouter` для организации эндпоинтов.
*   Рекомендуется версионирование API (например, `/api/v1/...`).
*   Автоматическая генерация документации OpenAPI (Swagger UI и ReDoc) доступна по путям `/docs` и `/redoc` соответственно для каждого FastAPI сервиса.

## Разработка нового микросервиса

1.  Создайте новую директорию в `backend/` (например, `backend/new_service/`).
2.  Добавьте `app.py`, `Dockerfile`, `requirements.txt`.
3.  Скопируйте структуру `api/` из существующего сервиса для организации роутеров.
4.  Добавьте сервис в `docker-compose.yml`.
5.  Используйте общие модули из `backend/shared/` по мере необходимости. 