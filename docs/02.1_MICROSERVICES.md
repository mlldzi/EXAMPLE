# Микросервисы Бэкенда

## 1. `auth_service`

*   **Назначение**: Управление аутентификацией пользователей и выдача JWT токенов.
*   **Основные эндпоинты (примеры, могут быть в `api/v1/endpoints/auth.py`):**
    *   `POST /api/v1/auth/register`: Регистрация нового пользователя.
        *   Принимает: `UserCreate` schema.
        *   Возвращает: `UserRead` (или `UserWithToken` с первым токеном).
    *   `POST /api/v1/auth/login`: Вход пользователя.
        *   Принимает: `LoginRequest` schema (email, password).
        *   Возвращает: `Token` schema (access_token, refresh_token).
    *   `POST /api/v1/auth/refresh`: Обновление access токена.
        *   Принимает: `RefreshTokenRequest` schema (refresh_token).
        *   Возвращает: `Token` schema (новый access_token, опционально новый refresh_token).
    *   `POST /api/v1/auth/logout`: (Опционально) Инвалидация refresh токена на бэкенде.
    *   `POST /api/v1/auth/password-reset-request`: Запрос на сброс пароля.
    *   `POST /api/v1/auth/password-reset-confirm`: Подтверждение сброса пароля.
    *   `GET /api/v1/auth/me`: Получение информации о текущем аутентифицированном пользователе (требует access токена).
        *   Возвращает: `UserRead` schema.
*   **Зависимости**: `MongoDB` (для хранения пользователей, если `user_service` не делает это эксклюзивно, или для хранения отозванных токенов), `Redis` (опционально, для черных списков токенов или rate limiting).

## 2. `user_service`

*   **Назначение**: Управление данными пользователей (CRUD операции).
*   **Основные эндпоинты (примеры, могут быть в `api/v1/endpoints/users.py`):**
    *   `POST /api/v1/users/`: Создание нового пользователя (может быть доступно только администраторам или дублировать функционал `/register` из `auth_service` с нюансами).
        *   Принимает: `UserCreate`.
        *   Возвращает: `UserRead`.
    *   `GET /api/v1/users/`: Получение списка пользователей (с пагинацией, фильтрацией; доступ для администраторов).
        *   Возвращает: `Paginated[UserRead]`.
    *   `GET /api/v1/users/{user_id}`: Получение информации о конкретном пользователе.
        *   Возвращает: `UserRead`.
    *   `PUT /api/v1/users/{user_id}`: Полное обновление данных пользователя.
        *   Принимает: `UserUpdate` (или отдельную схему для полного обновления).
        *   Возвращает: `UserRead`.
    *   `PATCH /api/v1/users/{user_id}`: Частичное обновление данных пользователя.
        *   Принимает: `UserUpdate`.
        *   Возвращает: `UserRead`.
    *   `DELETE /api/v1/users/{user_id}`: Удаление пользователя.
*   **Зависимости**: `MongoDB` (для хранения информации о пользователях).

## 3. Добавление новых микросервисов

При необходимости расширения функционала (например, управление продуктами, заказами, статьями блога), создается новый микросервис:

1.  Создайте директорию (например, `backend/product_service/`).
2.  Инициализируйте базовые файлы: `app.py`, `Dockerfile`, `requirements.txt`.
3.  Определите Pydantic модели для ваших сущностей в `backend/shared/models/` (например, `product_schemas.py`) или локально в сервисе, если они не будут переиспользоваться.
4.  Реализуйте CRUD операции и другую бизнес-логику.
5.  Создайте роутеры в `product_service/api/v1/endpoints/`.
6.  Добавьте сервис в `docker-compose.yml`.
7.  Настройте подключение к БД (MongoDB или другой) через `backend/shared/config/settings.py` или локальные переменные окружения. 